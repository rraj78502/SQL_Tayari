
-------------------------------------------------------------------------------------------------------------------------
Display all the information of all salesmen
-------------------------------------------------------------------------------------------------------------------------

SELECT * FROM salesman;


-------------------------------------------------------------------------------------------------------------------------
Display a given string
-------------------------------------------------------------------------------------------------------------------------

SELECT "This is SQL Exercise, Practice and Solution";


-------------------------------------------------------------------------------------------------------------------------
Display numbers in columns
-------------------------------------------------------------------------------------------------------------------------

SELECT 5, 10, 15;


-------------------------------------------------------------------------------------------------------------------------
Display sum of two numbers
-------------------------------------------------------------------------------------------------------------------------

SELECT 10 + 15;


-------------------------------------------------------------------------------------------------------------------------
Display the result of an arithmetic expression
-------------------------------------------------------------------------------------------------------------------------

SELECT 10 + 15 - 5 * 2;


-------------------------------------------------------------------------------------------------------------------------
Select specific columns from a table
-------------------------------------------------------------------------------------------------------------------------

SELECT name, commission
FROM salesman;


-------------------------------------------------------------------------------------------------------------------------
Select columns in different order
-------------------------------------------------------------------------------------------------------------------------

SELECT ord_date, salesman_id, ord_no, purch_amt
FROM orders;


-------------------------------------------------------------------------------------------------------------------------
Select distinct values from a table
-------------------------------------------------------------------------------------------------------------------------

SELECT DISTINCT salesman_id
FROM orders;


-------------------------------------------------------------------------------------------------------------------------
Select specified columns with where clause
-------------------------------------------------------------------------------------------------------------------------

SELECT name,city
FROM salesman
WHERE city='Paris';


-------------------------------------------------------------------------------------------------------------------------
Select all columns against a specified condition
-------------------------------------------------------------------------------------------------------------------------

SELECT *FROM customer
WHERE grade=200;


-------------------------------------------------------------------------------------------------------------------------
Select order number, order date and the purchase amount for each order which will be delivered by a specified salesman
-------------------------------------------------------------------------------------------------------------------------

SELECT ord_no, ord_date, purch_amt
FROM orders
WHERE salesman_id=5001;


-------------------------------------------------------------------------------------------------------------------------
Display the Nobel prizes for 1970
-------------------------------------------------------------------------------------------------------------------------

SELECT year,subject,winner 
FROM nobel_win 
WHERE year=1970;


-------------------------------------------------------------------------------------------------------------------------
Who won the 1971 prize for Literature
-------------------------------------------------------------------------------------------------------------------------

SELECT winner
  FROM nobel_win
 WHERE year = 1971
   AND subject = 'Literature';


-------------------------------------------------------------------------------------------------------------------------
Display the year and subject that won 'Dennis Gabor' his prize
-------------------------------------------------------------------------------------------------------------------------

SELECT year, subject
  FROM nobel_win
 WHERE winner = 'Dennis Gabor';


-------------------------------------------------------------------------------------------------------------------------
Filter the name of the 'Physics' winners since the year 1950
-------------------------------------------------------------------------------------------------------------------------

SELECT winner 
FROM nobel_win
WHERE year>=1950
AND subject='Physics';


-------------------------------------------------------------------------------------------------------------------------
Show all the details of the Chemistry prize winners between the year 1965 to 1975 inclusive
-------------------------------------------------------------------------------------------------------------------------

SELECT year, subject, winner, country
  FROM nobel_win
 WHERE subject = 'Chemistry'
   AND year>=1965 AND year<=1975;


-------------------------------------------------------------------------------------------------------------------------
Show all details of the Prime Ministerial winners after 1972 of Menachem Begin and Yitzhak Rabin
-------------------------------------------------------------------------------------------------------------------------

SELECT * FROM nobel_win
 WHERE year >1972
  AND winner IN ('Menachem Begin',
                  'Yitzhak Rabin');


-------------------------------------------------------------------------------------------------------------------------
Show all the details of the winners with first name Louis
-------------------------------------------------------------------------------------------------------------------------

SELECT *
 FROM nobel_win 
   WHERE winner LIKE 'Louis %';


-------------------------------------------------------------------------------------------------------------------------
Show all the winners in Physics for 1970 together with the winner of Economics for 1971
-------------------------------------------------------------------------------------------------------------------------

SELECT * FROM nobel_win  WHERE (subject ='Physics' AND year=1970) UNION (SELECT * FROM nobel_win  WHERE (subject ='Economics' AND year=1971));


-------------------------------------------------------------------------------------------------------------------------
Show all the winners of nobel prize in the year 1970 except the subject Physiology and Economics
-------------------------------------------------------------------------------------------------------------------------

SELECT *
 FROM nobel_win 
   WHERE year=1970
    AND subject NOT IN('Physiology','Economics');


-------------------------------------------------------------------------------------------------------------------------
Show the winners of a 'Physiology' prize in an early year before 1971 together with winners of a 'Peace' prize in a later year on and after the 1974
-------------------------------------------------------------------------------------------------------------------------

SELECT * FROM nobel_win WHERE (subject ='Physiology' AND year<1971) UNION (SELECT * FROM nobel_win WHERE (subject ='Peace' AND year>=1974));


-------------------------------------------------------------------------------------------------------------------------
Find all details of the prize won by Johannes Georg Bednorz
-------------------------------------------------------------------------------------------------------------------------

SELECT *
 FROM nobel_win 
   WHERE winner='Johannes Georg Bednorz';


-------------------------------------------------------------------------------------------------------------------------
Find all the details of the nobel winners for the subject not started with the letter 'P' and arranged the list as the most recent comes first, then by name in order
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
 FROM nobel_win 
  WHERE subject NOT LIKE 'P%' 
   ORDER BY year DESC, winner;


-------------------------------------------------------------------------------------------------------------------------
Find all the details of 1970 winners by the ordered to subject and winner name; but the list contain the subject Economics and Chemistry at last
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM nobel_win
WHERE year=1970 
ORDER BY
 CASE
    WHEN subject IN ('Economics','Chemistry') THEN 1
    ELSE 0
 END ASC,
 subject,
 winner;


-------------------------------------------------------------------------------------------------------------------------
Find all the products with a price between Rs.200 and Rs.600
-------------------------------------------------------------------------------------------------------------------------

SELECT * FROM item_mast
   WHERE pro_price BETWEEN 200 AND 600;


-------------------------------------------------------------------------------------------------------------------------
Calculate the average price of all products of the manufacturer which code is 16
-------------------------------------------------------------------------------------------------------------------------

SELECT AVG(pro_price) FROM item_mast 
  WHERE pro_com=16;


-------------------------------------------------------------------------------------------------------------------------
Find the item name and price in Rs.
-------------------------------------------------------------------------------------------------------------------------

SELECT pro_name as "Item Name", pro_price AS "Price in Rs."
    FROM item_mast;


-------------------------------------------------------------------------------------------------------------------------
Display the name and price of all the items with a price is equal or more than Rs.250, and make a list that contain the larger price first and then by name in ascending order
-------------------------------------------------------------------------------------------------------------------------

SELECT pro_name, pro_price 
     FROM item_mast
    WHERE pro_price >= 250
 ORDER BY pro_price DESC, pro_name;


-------------------------------------------------------------------------------------------------------------------------
Display the average price of the items for each company, showing only the company code
-------------------------------------------------------------------------------------------------------------------------

SELECT AVG(pro_price), pro_com
    FROM item_mast
GROUP BY pro_com;


-------------------------------------------------------------------------------------------------------------------------
Find the name and price of the cheapest item(s)
-------------------------------------------------------------------------------------------------------------------------

SELECT pro_name, pro_price
   FROM item_mast
   WHERE pro_price = 
    (SELECT MIN(pro_price) FROM item_mast);


-------------------------------------------------------------------------------------------------------------------------
Find the last name of all employees, without duplicates
-------------------------------------------------------------------------------------------------------------------------

SELECT DISTINCT emp_lname
FROM emp_details;


-------------------------------------------------------------------------------------------------------------------------
Find the data of employees whose last name is 'Snares'
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
 FROM emp_details 
  WHERE emp_lname= 'Snares';


-------------------------------------------------------------------------------------------------------------------------
Display all the data of employees that work in the department 57
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
 FROM emp_details 
  WHERE emp_dept= 57;


-------------------------------------------------------------------------------------------------------------------------
Display all information with specified conditions
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM customer 
WHERE grade > 100;


-------------------------------------------------------------------------------------------------------------------------
Display all information using AND operator with specified conditions
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM customer 
WHERE city = 'New York' AND grade>100;


-------------------------------------------------------------------------------------------------------------------------
Display all information using OR operator with specified conditions
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM customer 
WHERE city = 'New York' OR grade>100;


-------------------------------------------------------------------------------------------------------------------------
Display all information using OR, NOT operator with specified conditions
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM customer 
WHERE city = 'New York' OR NOT grade>100;


-------------------------------------------------------------------------------------------------------------------------
Display all customers, who are neither belongs to the city New York nor with a grade above 100
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM customer 
WHERE NOT (city = 'New York' OR grade>100);


-------------------------------------------------------------------------------------------------------------------------
Using AND, OR operator with a specified condition
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM  orders 
WHERE NOT ((ord_date ='2012-09-10' 
AND salesman_id>5005) 
OR purch_amt>1000.00);


-------------------------------------------------------------------------------------------------------------------------
Using AND operator with a specified condition
-------------------------------------------------------------------------------------------------------------------------

SELECT salesman_id,name,city,commission 
FROM salesman 
WHERE (commission > 0.10 
AND commission< 0.12);


-------------------------------------------------------------------------------------------------------------------------
Using NOT, AND operators with specified condition
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM  orders 
WHERE(purch_amt<200 OR 
NOT(ord_date>='2012-02-10' 
AND customer_id<3009));


-------------------------------------------------------------------------------------------------------------------------
Using NOT, OR & AND operators
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM  orders 
WHERE NOT((ord_date ='2012-08-17' 
OR customer_id>3005) 
AND purch_amt<1000);


-------------------------------------------------------------------------------------------------------------------------
Using precedence with specified condition
-------------------------------------------------------------------------------------------------------------------------

SELECT ord_no,purch_amt, 
(100*purch_amt)/6000 AS "Achieved %", 
(100*(6000-purch_amt)/6000) AS "Unachieved %" 
FROM  orders 
WHERE (100*purch_amt)/6000>50;


-------------------------------------------------------------------------------------------------------------------------
Find those employees whose last name is Dosni or Mardy
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
 FROM emp_details
  WHERE emp_lname ='Dosni' OR emp_lname= 'Mardy';


-------------------------------------------------------------------------------------------------------------------------
Display all the data of employees that work in department 47 or department 63
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
 FROM emp_details
  WHERE emp_dept = 47 OR emp_dept = 63;


-------------------------------------------------------------------------------------------------------------------------
Filter records using where clause and or operator
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM salesman 
WHERE city = 'Paris' OR city = 'Rome';


-------------------------------------------------------------------------------------------------------------------------
Filter records using in operator
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM salesman 
WHERE city IN('Paris','Rome');


-------------------------------------------------------------------------------------------------------------------------
Filter records using not in operator
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM salesman 
WHERE city NOT IN('Paris','Rome');


-------------------------------------------------------------------------------------------------------------------------
Sort records using in operator
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM customer 
WHERE customer_id IN (3007,3008,3009);


-------------------------------------------------------------------------------------------------------------------------
Using between operator to get a value from a range
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM salesman 
WHERE commission BETWEEN 0.12 AND 0.14;


-------------------------------------------------------------------------------------------------------------------------
Using between, not and in operators to filter records
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM orders 
WHERE (purch_amt BETWEEN 500 AND 4000) 
AND NOT purch_amt IN(948.50,1983.43);


-------------------------------------------------------------------------------------------------------------------------
Using where clause with between operator
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM salesman
WHERE name BETWEEN 'A' and 'L';


-------------------------------------------------------------------------------------------------------------------------
Using where clause with not and between operators
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM salesman
WHERE name NOT BETWEEN 'A' and 'L';


-------------------------------------------------------------------------------------------------------------------------
Using where clause with like operator
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM customer
WHERE cust_name LIKE 'B%';


-------------------------------------------------------------------------------------------------------------------------
Using where clause with like operator to filter records
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM customer
WHERE cust_name LIKE '%n';


-------------------------------------------------------------------------------------------------------------------------
Using where, like and underscore operators
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM salesman
WHERE name LIKE 'N__l%';


-------------------------------------------------------------------------------------------------------------------------
Using where clause like, underscore, escape operators
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM testtable
WHERE col1 LIKE '%/_%' ESCAPE '/';


-------------------------------------------------------------------------------------------------------------------------
Using where clause with not like, underscore operators
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM testtable
WHERE col1 NOT LIKE '%/_%' ESCAPE '/';


-------------------------------------------------------------------------------------------------------------------------
Using where clause with like operator and escape character
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM testtable
WHERE col1 LIKE '%//%' ESCAPE '/';


-------------------------------------------------------------------------------------------------------------------------
Using where clause with not like operator and escape character
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM testtable
WHERE col1 NOT LIKE '%//%' ESCAPE '/';


-------------------------------------------------------------------------------------------------------------------------
Using where clause with not like operator and escape character
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM testtable
WHERE col1 LIKE '%/_//%' ESCAPE '/';


-------------------------------------------------------------------------------------------------------------------------
Using not like operator and escape characters
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM testtable
WHERE col1 NOT LIKE '%/_//%' ESCAPE '/';


-------------------------------------------------------------------------------------------------------------------------
Find rows using like operator and % character
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM testtable
WHERE col1 LIKE '%/%%' ESCAPE'/';


-------------------------------------------------------------------------------------------------------------------------
Filter rows using not like and % character
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM testtable
WHERE col1 NOT LIKE '%/%%' ESCAPE'/';


-------------------------------------------------------------------------------------------------------------------------
Filter rows against NULL
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM customer
WHERE grade IS NULL;


-------------------------------------------------------------------------------------------------------------------------
Using where clause with not operator and NULL
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM customer
WHERE grade IS NOT NULL;


-------------------------------------------------------------------------------------------------------------------------
Display all the data of employees whose last name begins with the letter 'D'
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
 FROM emp_details
  WHERE emp_lname LIKE 'D%';


-------------------------------------------------------------------------------------------------------------------------
Find the total purchase amount for all orders
-------------------------------------------------------------------------------------------------------------------------

SELECT SUM (purch_amt) 
FROM orders;


-------------------------------------------------------------------------------------------------------------------------
Find the average purchase amount of all orders
-------------------------------------------------------------------------------------------------------------------------

SELECT AVG (purch_amt) 
FROM orders;


-------------------------------------------------------------------------------------------------------------------------
Find the number of salesman currently listing for all of their customers
-------------------------------------------------------------------------------------------------------------------------

SELECT COUNT (DISTINCT salesman_id) 
FROM orders;


-------------------------------------------------------------------------------------------------------------------------
Find number of customers have listed their names
-------------------------------------------------------------------------------------------------------------------------

SELECT COUNT(*) 
FROM customer;


-------------------------------------------------------------------------------------------------------------------------
Find the number of customers who gets at least a gradation for his/her performance
-------------------------------------------------------------------------------------------------------------------------

SELECT COUNT (ALL grade) 
FROM customer;


-------------------------------------------------------------------------------------------------------------------------
Find the maximum purchase amount of all the orders
-------------------------------------------------------------------------------------------------------------------------

SELECT MAX (purch_amt) 
FROM orders;


-------------------------------------------------------------------------------------------------------------------------
Find the minimum purchase amount of all the orders
-------------------------------------------------------------------------------------------------------------------------

SELECT MIN(purch_amt) 
FROM orders;


-------------------------------------------------------------------------------------------------------------------------
Find the highest grade for each of the cities of the customers
-------------------------------------------------------------------------------------------------------------------------

SELECT city,MAX(grade) 
FROM customer 
GROUP BY city;


-------------------------------------------------------------------------------------------------------------------------
Find the highest purchase amount ordered by the each customer
-------------------------------------------------------------------------------------------------------------------------

SELECT customer_id,MAX(purch_amt) 
FROM orders 
GROUP BY customer_id;


-------------------------------------------------------------------------------------------------------------------------
Find the highest purchase amount ordered by the each customer on a particular date
-------------------------------------------------------------------------------------------------------------------------

SELECT customer_id,ord_date,MAX(purch_amt) 
FROM orders 
GROUP BY customer_id,ord_date;


-------------------------------------------------------------------------------------------------------------------------
Highest purchase amount on a particular date for individual salesman
-------------------------------------------------------------------------------------------------------------------------

SELECT salesman_id,MAX(purch_amt) 
FROM orders 
WHERE ord_date = '2012-08-17' 
GROUP BY salesman_id;


-------------------------------------------------------------------------------------------------------------------------
Find the highest purchase amount of the customers in a particular date
-------------------------------------------------------------------------------------------------------------------------

SELECT customer_id,ord_date,MAX(purch_amt) 
FROM orders 
GROUP BY customer_id,ord_date 
HAVING MAX(purch_amt)>2000.00;


-------------------------------------------------------------------------------------------------------------------------
Find higher purchase amount of customers within a specific range
-------------------------------------------------------------------------------------------------------------------------

SELECT customer_id,ord_date,MAX(purch_amt) 
FROM orders 
GROUP BY customer_id,ord_date 
HAVING MAX(purch_amt) BETWEEN 2000 AND 6000;


-------------------------------------------------------------------------------------------------------------------------
Find higher purchase amount by the customer within a specific list
-------------------------------------------------------------------------------------------------------------------------

SELECT customer_id,ord_date,MAX(purch_amt) 
FROM orders 
GROUP BY customer_id,ord_date 
HAVING MAX(purch_amt) IN(2000 ,3000,5760, 6000);


-------------------------------------------------------------------------------------------------------------------------
Find the highest purchase amount from the customers whose IDs are in a range
-------------------------------------------------------------------------------------------------------------------------

SELECT customer_id,MAX(purch_amt) 
FROM orders 
WHERE customer_id BETWEEN 3002 and 3007 
GROUP BY customer_id;


-------------------------------------------------------------------------------------------------------------------------
Find customer details (within a specific range) and purchase amount more than a specific amount
-------------------------------------------------------------------------------------------------------------------------

SELECT customer_id,MAX(purch_amt) 
FROM orders 
WHERE customer_id BETWEEN 3002 and 3007 
GROUP BY customer_id 
HAVING MAX(purch_amt)>1000;


-------------------------------------------------------------------------------------------------------------------------
Find highest purchase amount by the customer from the salesman with a specified ID range
-------------------------------------------------------------------------------------------------------------------------

SELECT salesman_id,MAX(purch_amt) 
FROM orders 
GROUP BY salesman_id 
HAVING salesman_id BETWEEN 5003 AND 5008;


-------------------------------------------------------------------------------------------------------------------------
Count all orders of a specific date
-------------------------------------------------------------------------------------------------------------------------

SELECT COUNT(*) 
FROM orders 
WHERE ord_date='2012-08-17';


-------------------------------------------------------------------------------------------------------------------------
Count the number of different non NULL city values for salesmen
-------------------------------------------------------------------------------------------------------------------------

SELECT COUNT(*) 
FROM salesman 
WHERE city IS NOT NULL;


-------------------------------------------------------------------------------------------------------------------------
Count the number of salesmen registering orders for each day
-------------------------------------------------------------------------------------------------------------------------

SELECT ord_date,salesman_id,COUNT(*) 
FROM orders 
GROUP BY ord_date,salesman_id;


-------------------------------------------------------------------------------------------------------------------------
Calculate the average price of all the products
-------------------------------------------------------------------------------------------------------------------------

SELECT AVG(pro_price) AS "Average Price" 
   FROM item_mast;


-------------------------------------------------------------------------------------------------------------------------
Find the number of products with a price more than or equal to Rs.350
-------------------------------------------------------------------------------------------------------------------------

SELECT COUNT(*) AS "Number of Products" 
  FROM item_mast 
    WHERE pro_price >= 350;


-------------------------------------------------------------------------------------------------------------------------
Display the average price of each company's products, along with their code
-------------------------------------------------------------------------------------------------------------------------

SELECT AVG(pro_price) AS "Average Price", 
       pro_com AS "Company ID"
    FROM item_mast
GROUP BY pro_com;


-------------------------------------------------------------------------------------------------------------------------
Find the sum of the allotment amount of all departments
-------------------------------------------------------------------------------------------------------------------------

SELECT SUM(dpt_allotment) 
FROM emp_department;


-------------------------------------------------------------------------------------------------------------------------
Find the number of employees in each department along with the department code
-------------------------------------------------------------------------------------------------------------------------

SELECT emp_dept, COUNT(*)
  FROM emp_details
  GROUP BY emp_dept;


-------------------------------------------------------------------------------------------------------------------------
Salesmen commission with the percent sign ( % )
-------------------------------------------------------------------------------------------------------------------------

SELECT salesman_id,name,city,'%',commission*100 
FROM salesman;


-------------------------------------------------------------------------------------------------------------------------
Number of orders booked for each day and display it in a specific format
-------------------------------------------------------------------------------------------------------------------------

SELECT ' For',ord_date,',there are', 
COUNT (ord_no),'orders.' 
FROM orders 
GROUP BY ord_date;


-------------------------------------------------------------------------------------------------------------------------
Display the orders according to the order number arranged by ascending order
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM orders 
ORDER BY ord_no;


-------------------------------------------------------------------------------------------------------------------------
Arrange the orders according to the order date (latest will come first then previous)
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM orders 
ORDER BY ord_date DESC;


-------------------------------------------------------------------------------------------------------------------------
Display the orders according to older date with highest purchase amount will come first
-------------------------------------------------------------------------------------------------------------------------

SELECT * 
FROM orders 
ORDER BY ord_date, purch_amt DESC;


-------------------------------------------------------------------------------------------------------------------------
Display customer name, city, grade (according to the smallest ID)
-------------------------------------------------------------------------------------------------------------------------

SELECT cust_name,city,grade 
FROM customer 
ORDER BY customer_id;


-------------------------------------------------------------------------------------------------------------------------
Salesman details by smallest ID along with order date
-------------------------------------------------------------------------------------------------------------------------

SELECT salesman_id,ord_date,MAX(purch_amt) 
FROM orders 
GROUP BY salesman_id,ord_date 
ORDER BY salesman_id,ord_date;


-------------------------------------------------------------------------------------------------------------------------
Display customer name, city and grade by highest grade
-------------------------------------------------------------------------------------------------------------------------

SELECT cust_name,city,grade 
FROM customer 
ORDER BY 3 DESC;


-------------------------------------------------------------------------------------------------------------------------
Find largest number of orders booked by the customer
-------------------------------------------------------------------------------------------------------------------------

SELECT customer_id, COUNT(DISTINCT ord_no), 
MAX(purch_amt) 
FROM orders 
GROUP BY customer_id 
ORDER BY 2 DESC;


-------------------------------------------------------------------------------------------------------------------------
Latest order date (comes last) along with the total purchase amount and commission
-------------------------------------------------------------------------------------------------------------------------

SELECT ord_date, SUM(purch_amt), 
SUM(purch_amt)*.15 
FROM orders 
GROUP BY ord_date 
ORDER BY ord_date;



-------------------------------------------------------------------------------------------------------------------------
Find the customer and salesmen who lives in same city
-------------------------------------------------------------------------------------------------------------------------

SELECT customer.cust_name,
salesman.name, salesman.city
FROM salesman, customer
WHERE salesman.city = customer.city;


-------------------------------------------------------------------------------------------------------------------------
Find the customers along with the salesmen who works for them
-------------------------------------------------------------------------------------------------------------------------

SELECT customer.cust_name, salesman.name
FROM customer,salesman
WHERE salesman.salesman_id = customer.salesman_id;


-------------------------------------------------------------------------------------------------------------------------
Orders by the customers not located in the same cities where their salesmen live
-------------------------------------------------------------------------------------------------------------------------

SELECT ord_no, cust_name, orders.customer_id, orders.salesman_id
FROM salesman, customer, orders
WHERE customer.city <> salesman.city
AND orders.customer_id = customer.customer_id
AND orders.salesman_id = salesman.salesman_id;


-------------------------------------------------------------------------------------------------------------------------
Find out customers who made the order
-------------------------------------------------------------------------------------------------------------------------

SELECT orders.ord_no, customer.cust_name
FROM orders, customer
WHERE orders.customer_id = customer.customer_id;


-------------------------------------------------------------------------------------------------------------------------
Sort out the customer their grade and order no who made at least an order
-------------------------------------------------------------------------------------------------------------------------

SELECT customer.cust_name AS "Customer",
customer.grade AS "Grade",orders.ord_no AS "Order No."
FROM orders, salesman, customer
WHERE orders.customer_id = customer.customer_id
AND orders.salesman_id = salesman.salesman_id
AND salesman.city IS NOT NULL
AND customer.grade IS NOT NULL;


-------------------------------------------------------------------------------------------------------------------------
Find customers details who served by a salesman and commission within a range
-------------------------------------------------------------------------------------------------------------------------

SELECT customer.cust_name AS "Customer",
customer.city AS "City",
salesman.name AS "Salesman",
salesman.commission
FROM customer,salesman
WHERE customer.salesman_id = salesman.salesman_id
AND salesman.commission
BETWEEN .12 AND .14;


-------------------------------------------------------------------------------------------------------------------------
Find salesman commission details where customer grade is 200 or more
-------------------------------------------------------------------------------------------------------------------------

SELECT ord_no, cust_name, commission AS "Commission%",
purch_amt*commission AS "Commission"
FROM salesman,orders,customer
WHERE orders.customer_id = customer.customer_id
AND orders.salesman_id = salesman.salesman_id
AND customer.grade>=200;


-------------------------------------------------------------------------------------------------------------------------
Find all customers with orders on October 5, 2012.
-------------------------------------------------------------------------------------------------------------------------

SELECT *
FROM customer a,orders  b 
WHERE a.customer_id=b.customer_id 
AND b.ord_date='2012-10-05';


